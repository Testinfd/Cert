<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Announcement Generator | Pragati Assam</title>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Assamese:wght@100..900&family=Cormorant+Garamond:wght@300;400;500;600;700&family=Montserrat:wght@100..900&family=Raleway:wght@100..700&family=Great+Vibes&family=Inter:wght@200..900&family=Poppins:wght@300;400;500;600;700&family=Space+Grotesk:wght@300..700&display=swap" rel="stylesheet">
    <!-- Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
      // Real-time preview update function
      function updatePreview() {
        const title = document.getElementById('titleInput').value;
        const content = document.getElementById('contentInput').value;
        const date = document.getElementById('dateInput').value;
        const signerName = document.getElementById('signerNameInput').value;
        const signerTitle = document.getElementById('signerTitleInput').value;
        const contactInfo = document.getElementById('contactInfoInput').value;
        const noticeType = document.getElementById('templateSelector').value.toUpperCase();
        const logoText = document.getElementById('logoTextInput').value || 'PA';
        
        // Update text content
        if (title) document.getElementById('announcementTitle').textContent = title;
        if (content) document.getElementById('announcementContent').textContent = content;
        if (date) document.getElementById('announcementDate').textContent = `Date: ${new Date(date).toLocaleDateString('en-US', {year: 'numeric', month: 'long', day: 'numeric'})}`;
        if (signerName) document.getElementById('signerName').textContent = signerName;
        if (signerTitle) document.getElementById('signerTitle').textContent = signerTitle;
        if (contactInfo) document.getElementById('contactInfo').textContent = contactInfo;
        if (noticeType) document.getElementById('noticeType').textContent = noticeType;
        
        // Update logo text if no image is loaded
        const logoEl = document.getElementById('announcementLogo');
        if (!logoEl.classList.contains('has-image')) {
          logoEl.innerHTML = logoText;
        }
        
        // Update theme colors
        const primaryColor = document.querySelector('[data-target="primary"]').value;
        const secondaryColor = document.querySelector('[data-target="secondary"]').value;
        const accentColor = document.querySelector('[data-target="accent"]').value;
        
        document.documentElement.style.setProperty('--primary-color', primaryColor);
        document.documentElement.style.setProperty('--secondary-color', secondaryColor);
        document.documentElement.style.setProperty('--accent-color', accentColor);
      }
      
      // Add event listeners to all form inputs
      document.addEventListener('DOMContentLoaded', function() {
        const inputs = document.querySelectorAll('.controls input, .controls textarea, .controls select');
        inputs.forEach(input => {
          input.addEventListener('input', updatePreview);
        });
      });
    </script>

    <style>
        :root {
            --primary-color: #2a3b4c;
            --secondary-color: #ce8e2c;
            --accent-color: #134e65;
            --text-color: #333;
            --light-color: #f7f9fc;
            --border-color: rgba(42, 59, 76, 0.2);
            --gradient-start: rgba(206, 142, 44, 0.07);
            --gradient-end: rgba(19, 78, 101, 0.05);
            --primary-color-rgb: 42, 59, 76;
            --secondary-color-rgb: 206, 142, 44;
            --accent-color-rgb: 19, 78, 101;
            --assamese-font: 'Noto Sans Assamese', sans-serif;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Assamese Text Support */
        .assamese-text {
            font-family: var(--assamese-font);
        }

        body {
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(135deg, #f0f2f5, #e6e9ed);
            color: var(--text-color);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 25px;
            overflow-x: hidden;
        }

        .container {
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 400px 1fr;
            gap: 40px;
            align-items: start;
            padding: 20px;
        }

        /* Controls styling */
        .controls {
            width: 100%;
            max-width: 450px; /* Adjust width for side layout */
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
            position: sticky; /* Make controls sticky */
            top: 25px;
            max-height: calc(100vh - 50px); /* Limit height */
            overflow-y: auto; /* Allow scrolling */
        }

        .controls h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 22px;
            margin-bottom: 25px;
            color: var(--primary-color);
            position: relative;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }

        .controls h2::after {
            content: '';
            position: absolute;
            width: 50px;
            height: 3px;
            background: var(--secondary-color);
            bottom: -1px; /* Align with border */
            left: 0;
        }

        .control-group {
            margin-bottom: 18px;
        }

        .control-row {
            display: flex;
            gap: 15px;
        }

        .control-row .control-group {
            flex: 1;
        }

        .control-group label {
            display: block;
            font-family: 'Montserrat', sans-serif;
            font-size: 13px;
            margin-bottom: 6px;
            color: var(--primary-color);
            font-weight: 500;
        }

        .control-group input[type="text"],
        .control-group input[type="date"],
        .control-group input[type="color"],
        .control-group input[type="file"],
        .control-group select,
        .control-group textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-family: 'Montserrat', sans-serif;
            font-size: 14px;
            color: var(--text-color);
            transition: all 0.3s ease;
            background-color: #fff;
        }

        .control-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .control-group input:focus,
        .control-group select:focus,
        .control-group textarea:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(var(--secondary-color-rgb), 0.2);
        }

        .button {
            background: var(--primary-color);
            color: white;
            font-family: 'Montserrat', sans-serif;
            font-size: 14px;
            font-weight: 500;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .button:hover {
            background: var(--secondary-color);
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .control-actions {
            display: flex;
            flex-wrap: wrap; /* Allow buttons to wrap */
            gap: 10px;
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }

        /* Theme options */
        .theme-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(70px, 1fr)); /* Responsive grid */
            gap: 10px;
            margin-top: 10px;
        }

        .color-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 8px;
            border-radius: 6px;
            border: 2px solid transparent;
            text-align: center;
            background-color: var(--light-color);
        }

        .color-option.selected {
            border-color: var(--secondary-color);
            box-shadow: 0 3px 8px rgba(0,0,0,0.1);
            background-color: #fff;
        }

        .color-preview {
            display: flex;
            margin-bottom: 5px;
        }

        .color-preview span {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            margin: 0 2px;
            display: inline-block;
            border: 1px solid rgba(0,0,0,0.1);
        }

        .color-option p {
            font-size: 11px;
            font-family: 'Montserrat', sans-serif;
            font-weight: 500;
            color: var(--accent-color);
        }

        /* Custom Colors */
        .custom-colors {
            display: flex;
            justify-content: space-around; /* Space out pickers */
            gap: 15px;
            margin-top: 15px;
            padding: 10px;
            background-color: var(--light-color);
            border-radius: 6px;
        }

        .color-picker {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .color-picker label {
            font-size: 11px;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .color-picker input[type="color"] {
            width: 45px;
            height: 25px;
            padding: 0;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            cursor: pointer;
            -webkit-appearance: none; /* Override default appearance */
            -moz-appearance: none;
            appearance: none;
            background-color: transparent; /* Allow swatch to show */
        }
        .color-picker input[type="color"]::-webkit-color-swatch {
            border-radius: 3px;
            border: none;
        }
        .color-picker input[type="color"]::-moz-color-swatch {
            border-radius: 3px;
            border: none;
        }

        /* Toggle Switch */
        .toggle-switch-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px; /* Smaller */
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-switch label {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            border-radius: 24px;
            transition: .4s;
        }

        .toggle-switch label:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            border-radius: 50%;
            transition: .4s;
        }

        .toggle-switch input:checked + label {
            background-color: var(--secondary-color);
        }

        .toggle-switch input:checked + label:before {
            transform: translateX(26px); /* Adjusted for smaller size */
        }

        /* Range Control */
        .range-control {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }

        .range-control label {
             margin-bottom: 0; /* Override general label style */
             flex-shrink: 0; /* Prevent label from shrinking */
        }

        .range-control input[type="range"] {
            flex-grow: 1;
            height: 6px;
            cursor: pointer;
            background: var(--light-color);
            border-radius: 3px;
            accent-color: var(--secondary-color);
        }

        .range-control .range-value {
            font-size: 12px;
            color: var(--primary-color);
            font-weight: 500;
            min-width: 30px; /* Ensure space for value */
            text-align: right;
        }

        .image-overlay-controls {
            padding: 15px;
            margin-top: 10px;
            background-color: var(--light-color);
            border-radius: 6px;
            border: 1px solid var(--border-color);
        }

        /* Announcement styling */
        .announcement-preview-area {
            position: sticky;
            top: 20px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 30px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            min-height: calc(100vh - 40px);
            overflow-y: auto;
        }

        .announcement-container {
            width: 100%;
            max-width: 840px; /* A4 ratio approx */
            transform-origin: top center;
            /* Removed perspective/rotate for simpler default view */
        }

        .announcement {
            width: 100%; /* Use container width */
            min-height: 1188px; /* A4 ratio approx height */
            background: white;
            position: relative;
            padding: 40px 50px; /* Adjust padding */
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin: 0 auto;
            overflow: hidden;
            transition: all 0.3s ease;
            border: 1px solid #eee;
            /* Removed transform styles */
        }

        .announcement-backdrop {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0; /* Behind content */
            pointer-events: none;
            overflow: hidden;
        }

        .announcement-backdrop .watermark {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-35deg);
            font-family: 'Montserrat', sans-serif;
            font-size: 120px;
            font-weight: 800;
            color: rgba(var(--secondary-color-rgb), 0.05); /* Very subtle */
            white-space: nowrap;
            text-transform: uppercase;
            opacity: 0.5;
            z-index: 1;
        }

        .announcement-backdrop .pattern {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.05; /* Default opacity */
            z-index: 2;
        }

        /* --- Announcement Content --- */
        .announcement-header,
        .announcement-title-box,
        .announcement-content,
        .announcement-footer,
        .announcement-contact {
             position: relative; /* Ensure content is above backdrop */
             z-index: 5;
        }

        .announcement-header {
            display: flex;
            align-items: center;
            margin-bottom: 35px;
            padding-bottom: 25px;
            border-bottom: 2px solid var(--secondary-color);
        }

        .announcement-logo {
            width: 90px;
            height: 90px;
            border-radius: 8px; /* Slightly rounded square */
            margin-right: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Montserrat', sans-serif;
            font-size: 36px;
            font-weight: 700;
            color: var(--primary-color);
            background: var(--light-color);
            border: 1px solid var(--border-color);
            overflow: hidden;
            flex-shrink: 0;
            position: relative; /* For logo container */
        }

        .logo-container {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 5px;
            background: transparent; /* Ensure container itself is transparent */
            width: 100%;
            height: 100%;
        }

        .logo-container img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            display: block; /* Prevents extra space below image */
            width: auto;
            height: auto;
            border-radius: 4px; /* Slightly rounded corners for better appearance */
        }
        
        /* Style for logo with image */
        .announcement-logo.has-image {
            background: transparent !important;
            border: 1px solid var(--border-color);
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .announcement-org {
            flex: 1;
        }

        .announcement-org-name {
            font-family: 'Montserrat', sans-serif;
            font-size: 26px;
            font-weight: 700;
            color: var(--primary-color);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }

        .announcement-org-tagline {
            font-family: 'Raleway', sans-serif;
            font-size: 14px;
            font-style: italic;
            color: var(--accent-color);
        }

        .announcement-title-box {
            text-align: center;
            margin: 30px 0 40px;
            position: relative;
        }

        .announcement-notice-type {
            display: inline-block;
            background: var(--secondary-color);
            color: white;
            padding: 6px 18px;
            font-family: 'Montserrat', sans-serif;
            font-size: 13px;
            font-weight: 600;
            text-transform: uppercase;
            border-radius: 4px;
            margin-bottom: 15px;
            letter-spacing: 0.5px;
        }

        .announcement-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 30px;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 8px;
            line-height: 1.3;
            position: relative; /* For icons */
        }

        .announcement-title .icon {
            display: inline-block;
            width: 24px; /* Slightly smaller icon */
            height: 24px;
            vertical-align: middle;
            margin-right: 8px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            position: relative;
            top: -2px;
        }

        .announcement-date {
            font-family: 'Raleway', sans-serif;
            font-size: 14px;
            color: #555;
        }

        .announcement-content {
            font-family: 'Cormorant Garamond', serif;
            font-size: 17px; /* Slightly smaller default */
            line-height: 1.7;
            color: var(--text-color);
            margin-bottom: 40px;
            text-align: justify;
            white-space: pre-line;
        }

        .announcement-footer {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            margin-top: 50px;
            padding-top: 30px;
            border-top: 1px solid var(--border-color);
        }

        .announcement-signature {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .signature-img {
            height: 50px;
            margin-bottom: 10px;
        }

        .signature-name {
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            font-size: 16px;
            color: var(--primary-color);
        }

        .signature-title {
            font-family: 'Raleway', sans-serif;
            font-size: 14px;
            font-style: italic;
            color: var(--accent-color);
            margin-top: 3px;
        }

        .announcement-contact {
            margin-top: 40px;
            text-align: center;
            font-family: 'Raleway', sans-serif;
            font-size: 13px;
            color: #666;
            border-top: 1px dashed #ccc;
            padding-top: 20px;
        }

        /* --- Icon Styles --- */
        .announcement-title .icon-info { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23134e65"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>'); }
        .announcement-title .icon-alert { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23ce8e2c"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>'); }
        .announcement-title .icon-event { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%232a3b4c"><path d="M17 12h-5v5h5v-5zM16 1v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"/></svg>'); }
        .announcement-title .icon-award { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23ce8e2c"><path d="M19 5h-2V3H7v2H5c-1.1 0-2 .9-2 2v1c0 2.55 1.92 4.63 4.39 4.94.63 1.5 1.98 2.63 3.61 2.96V19H7v2h10v-2h-4v-3.1c1.63-.33 2.98-1.46 3.61-2.96C19.08 12.63 21 10.55 21 8V7c0-1.1-.9-2-2-2zM5 8V7h2v3.82C5.84 10.4 5 9.3 5 8zm14 0c0 1.3-.84 2.4-2 2.82V7h2v1z"/></svg>'); }
        .announcement-title .icon-calendar { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%232a3b4c"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"/></svg>'); }
        .announcement-title .icon-mail { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23134e65"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>'); }

        /* --- Background Gradient Styles --- */
        .bg-gradient { background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end)); }
        .bg-gradient-pastel { background: linear-gradient(135deg, #fdfcfb, #e2d1c3); }
        .bg-gradient-vibrant { background: linear-gradient(135deg, #667eea, #764ba2); }
        .bg-gradient-corporate { background: linear-gradient(135deg, #E0EAFC, #CFDEF3); }

        /* --- Background Pattern Styles --- */
        .pattern-dots { background-image: radial-gradient(var(--secondary-color) 1px, transparent 1px); background-size: 15px 15px; opacity: 0.08; }
        .pattern-lines { background-image: repeating-linear-gradient(45deg, var(--secondary-color) 0, var(--secondary-color) 1px, transparent 1px, transparent 10px), repeating-linear-gradient(-45deg, var(--accent-color) 0, var(--accent-color) 1px, transparent 1px, transparent 10px); opacity: 0.06; }
        .pattern-grid { background-image: linear-gradient(var(--primary-color) 1px, transparent 1px), linear-gradient(90deg, var(--primary-color) 1px, transparent 1px); background-size: 20px 20px; opacity: 0.05; }
        .pattern-circles { background-image: radial-gradient(circle at 25px 25px, var(--secondary-color) 2%, transparent 3%), radial-gradient(circle at 75px 75px, var(--accent-color) 2%, transparent 3%); background-size: 100px 100px; opacity: 0.08; }
        .pattern-waves { background-image: repeating-linear-gradient(0deg, var(--secondary-color), var(--secondary-color) 1px, transparent 1px, transparent 20px), repeating-linear-gradient(90deg, var(--accent-color), var(--accent-color) 1px, transparent 1px, transparent 20px), linear-gradient(45deg, transparent 0%, transparent 40%, var(--primary-color) 40%, var(--primary-color) 41%, transparent 41%, transparent 100%); opacity: 0.04; }

        /* --- Image Overlay --- */
        .announcement.announcement-with-image-overlay::before {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background-image: var(--overlay-image, none);
            background-size: cover;
            background-position: center;
            opacity: var(--overlay-opacity, 0.2);
            z-index: 1;
        }

        /* --- Text Effects --- */
        /* Apply effects to a wrapper or directly to title/content */
        .text-effect-shadow .announcement-title { text-shadow: 2px 2px 4px rgba(0,0,0,0.2); }
        .text-effect-outline .announcement-title { -webkit-text-stroke: 1px var(--primary-color); text-stroke: 1px var(--primary-color); color: transparent !important; text-shadow: 1px 1px 1px rgba(0,0,0,0.1); }
        .text-effect-gradient .announcement-title { background: linear-gradient(to right, var(--primary-color), var(--accent-color)); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; text-fill-color: transparent; }
        .text-effect-highlight .announcement-title { display: inline; background: linear-gradient(180deg, transparent 65%, rgba(var(--secondary-color-rgb), 0.4) 65%); padding: 0 5px; }
        .text-effect-underline .announcement-title::after { content: ''; position: absolute; width: 80%; height: 4px; bottom: -8px; left: 10%; background: linear-gradient(to right, var(--secondary-color), var(--accent-color)); border-radius: 2px; }
        /* Bold Effects */
        .text-effect-maximalist .announcement-title { font-size: calc(1.2em + 2vw); font-weight: 900; line-height: 1; text-transform: uppercase; letter-spacing: -2px; word-spacing: -5px; color: var(--primary-color); text-shadow: 3px 3px 0 var(--secondary-color), -3px -3px 0 var(--accent-color); transform: scale(1.05) translateX(-2%); transform-origin: left center; }
        .text-effect-distorted .announcement-title { font-size: calc(1.1em + 1.8vw); font-weight: 800; animation: textWave 8s ease-in-out infinite alternate; transform-origin: center; }
        @keyframes textWave { 0% { transform: skewX(0deg) skewY(0deg); } 50% { transform: skewX(2deg) skewY(-1deg) scale(1.02); } 100% { transform: skewX(-2deg) skewY(1deg); } }
        .text-effect-layered .announcement-title { font-weight: 900; color: transparent; -webkit-text-stroke: 1.5px var(--primary-color); letter-spacing: -1px; position: relative; } 
        .text-effect-layered .announcement-title::before { content: attr(data-title); position: absolute; top: 2px; left: 2px; width: 100%; height: 100%; color: var(--secondary-color); -webkit-text-stroke: 0; z-index: -1; }

        /* --- Accent Elements --- */
        /* Apply these classes to the body or a main container */
        .accent-corner-ribbon .announcement { overflow: visible; }
        .accent-corner-ribbon .announcement::before { content: ''; position: absolute; top: -8px; right: -8px; width: 120px; height: 120px; background-color: var(--secondary-color); transform: rotate(45deg); z-index: 6; }
        .accent-side-border .announcement { border-left: 10px solid var(--accent-color); }
        .accent-top-bottom-bars .announcement::before, .accent-top-bottom-bars .announcement::after { content: ''; position: absolute; left: 0; width: 100%; height: 8px; background: linear-gradient(to right, var(--primary-color), var(--accent-color)); z-index: 6; }
        .accent-top-bottom-bars .announcement::before { top: 0; }
        .accent-top-bottom-bars .announcement::after { bottom: 0; }
        .accent-decorative-corners .announcement > *:first-child::before, .accent-decorative-corners .announcement > *:first-child::after,
        .accent-decorative-corners .announcement > *:last-child::before, .accent-decorative-corners .announcement > *:last-child::after { content: ''; position: absolute; width: 25px; height: 25px; border-color: var(--accent-color); border-style: solid; z-index: 6; }
        .accent-decorative-corners .announcement > *:first-child::before { top: 15px; left: 15px; border-width: 2px 0 0 2px; }
        .accent-decorative-corners .announcement > *:first-child::after { top: 15px; right: 15px; border-width: 2px 2px 0 0; }
        .accent-decorative-corners .announcement > *:last-child::before { bottom: 15px; left: 15px; border-width: 0 0 2px 2px; }
        .accent-decorative-corners .announcement > *:last-child::after { bottom: 15px; right: 15px; border-width: 0 2px 2px 0; }
        .accent-paper-effect .announcement { box-shadow: 0 1px 3px rgba(0,0,0,.2), 0 0 30px rgba(0,0,0,.08) inset; }
        .accent-paper-effect .announcement::before, .accent-paper-effect .announcement::after { content: ''; position: absolute; z-index: -1; box-shadow: 0 0 15px rgba(0,0,0,0.5); top: 40%; bottom: 10px; left: 15px; right: 15px; border-radius: 100px / 8px; }

        /* --- Font Styles --- */
        /* Apply these classes to .announcement */
        .font-classic-serif .announcement-title { font-family: 'Times New Roman', Times, serif; font-weight: 700; letter-spacing: 0.5px; }
        .font-classic-serif .announcement-content { font-family: 'Georgia', serif; line-height: 1.8; }
        .font-modern-sans .announcement-title { font-family: 'Helvetica Neue', Arial, sans-serif; font-weight: 600; letter-spacing: -0.5px; }
        .font-modern-sans .announcement-content { font-family: 'Roboto', sans-serif; line-height: 1.6; }
        .font-elegant-script .announcement-title { font-family: 'Great Vibes', cursive; font-size: 42px; font-weight: 400; }
        .font-elegant-script .announcement-content { font-family: 'Cormorant Garamond', serif; font-size: 20px; line-height: 1.7; }
        .font-bold-impact .announcement-title { font-family: 'Impact', 'Arial Black', sans-serif; text-transform: uppercase; letter-spacing: 1px; }
        .font-bold-impact .announcement-content { font-family: 'Montserrat', sans-serif; font-weight: 500; }
        .font-minimal-clean .announcement-title { font-family: 'Raleway', sans-serif; font-weight: 300; letter-spacing: 2px; text-transform: uppercase; }
        .font-minimal-clean .announcement-content { font-family: 'Open Sans', sans-serif; font-weight: 300; line-height: 1.8; }
        .font-dynamic .announcement-title { font-size: clamp(2rem, 5vw, 3.5rem); line-height: 1.1; font-weight: 900; background: linear-gradient(135deg, var(--primary-color), var(--accent-color)); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; }
        .font-dynamic .announcement-content { font-size: clamp(1rem, 2vw, 1.15rem); line-height: 1.8; }

        /* --- Design Templates (Apply to .announcement) --- */
        .design-formal {
            font-family: 'Times New Roman', Times, serif;
            border: 1px solid #2c3e50;
            background: linear-gradient(to bottom, #f8f9fa, #fff);
        }
        .design-formal .announcement-header { background-color: #2c3e50; color: #fff; border-bottom: 2px solid gold; text-align: center; padding: 25px; }
        .design-formal .announcement-org-name { color: #fff; text-shadow: 1px 1px 2px rgba(0,0,0,0.2); }
        .design-formal .announcement-org-tagline { color: gold; }
        .design-formal .announcement-title { border-bottom: 1px solid #2c3e50; padding-bottom: 15px; font-size: 32px; }
        .design-formal .announcement-content { line-height: 1.8; text-align: justify; }
        .design-formal .announcement-footer { border-top: 1px solid #2c3e50; padding-top: 25px; }
        .design-formal .announcement-contact { background: #2c3e50; color: #fff; border-top: 1px solid gold; padding: 15px; }

        .design-modern { font-family: 'Roboto', sans-serif; box-shadow: 0 5px 15px rgba(0,0,0,0.1); border-radius: 10px; overflow: hidden; border: none; }
        .design-modern .announcement-header { background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); color: #fff; padding: 25px; border: none; }
        .design-modern .announcement-org-name, .design-modern .announcement-org-tagline { color: #fff; }
        .design-modern .announcement-title { font-family: 'Montserrat', sans-serif; font-weight: 600; letter-spacing: 0.5px; border-left: 4px solid var(--accent-color); padding-left: 15px; margin: 25px 0; font-size: 28px; }
        .design-modern .announcement-content { color: #444; line-height: 1.6; }
        .design-modern .announcement-footer { background-color: #f9f9f9; border-top: 1px dashed #ddd; font-size: 0.9em; padding: 20px 0; }
        .design-modern .announcement-contact { background-color: #f1f1f1; padding: 15px; font-size: 13px; border-top: none; }

        .design-creative { font-family: 'Poppins', sans-serif; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); overflow: hidden; border: none; }
        .design-creative .announcement-header { background-color: var(--primary-color); padding: 30px 25px; border-bottom: 5px solid var(--accent-color); color: #fff; }
        .design-creative .announcement-org-name, .design-creative .announcement-org-tagline { color: #fff; }
        .design-creative .announcement-title { color: var(--accent-color); position: relative; padding-bottom: 15px; font-family: 'Montserrat', sans-serif; font-size: 30px; }
        .design-creative .announcement-title:after { content: ''; position: absolute; width: 50px; height: 3px; background-color: var(--accent-color); bottom: 0; left: 0; }
        .design-creative .announcement-content { line-height: 1.7; padding: 25px; }
        .design-creative .announcement-footer { background-color: #f9f9f9; border-radius: 0 0 20px 20px; padding-top: 25px; }

        .design-minimalist { font-family: 'Inter', sans-serif; border: 1px solid #eee; padding: 40px 50px; box-shadow: none; }
        .design-minimalist .announcement-header { border-bottom: 1px solid #eee; padding-bottom: 25px; margin-bottom: 25px; }
        .design-minimalist .announcement-title { font-weight: 300; font-size: 26px; letter-spacing: 1px; margin-bottom: 35px; }
        .design-minimalist .announcement-notice-type { font-weight: 400; letter-spacing: 2px; border-bottom: none; background: #eee; color: #555; font-size: 12px; padding: 4px 12px; }
        .design-minimalist .announcement-content { font-weight: 300; line-height: 1.8; color: #333; }
        .design-minimalist .announcement-footer { margin-top: 40px; padding-top: 25px; border-top: 1px solid #eee; font-size: 0.9em; }

        .design-brutalist { font-family: 'Space Grotesk', monospace; border: 3px solid var(--primary-color); position: relative; overflow: visible; box-shadow: 6px 6px 0 var(--secondary-color); padding: 30px; }
        .design-brutalist::before { content: ''; position: absolute; top: 10px; left: 10px; width: calc(100% - 20px); height: calc(100% - 20px); border: 1px dashed var(--accent-color); z-index: 0; }
        .design-brutalist .announcement-header { border-bottom: 3px solid var(--primary-color); padding-bottom: 20px; }
        .design-brutalist .announcement-title-box { text-align: left; border: none; padding: 0; margin: 30px 0; }
        .design-brutalist .announcement-notice-type { background: var(--primary-color); font-size: 11px; letter-spacing: 2px; text-transform: uppercase; padding: 6px 12px; display: inline-block; margin-bottom: 15px; color: white; }
        .design-brutalist .announcement-title { font-size: 36px; font-weight: 700; text-transform: uppercase; line-height: 1.1; margin-bottom: 10px; word-spacing: -3px; letter-spacing: -1px; }
        .design-brutalist .announcement-content { font-size: 15px; line-height: 1.7; margin-bottom: 40px; }
        .design-brutalist .announcement-footer { border-top: 2px solid var(--primary-color); padding-top: 25px; margin-top: 40px; }
        .design-brutalist .signature-name { font-weight: 700; font-size: 18px; text-transform: uppercase; }
        .design-brutalist .announcement-contact { border-top: none; background-color: var(--secondary-color); color: var(--primary-color); padding: 15px; margin-top: 30px; text-align: center; font-weight: 500; }

        .design-dark-mode { color: white; background: #1e1e1e; box-shadow: 0 10px 30px rgba(0,0,0,0.4); border: 1px solid #333; }
        .design-dark-mode .announcement-header { border-bottom-color: rgba(255, 255, 255, 0.15); }
        .design-dark-mode .announcement-logo { background: #333; border-color: #555; color: var(--secondary-color); }
        .design-dark-mode .announcement-org-name { color: white; }
        .design-dark-mode .announcement-org-tagline { color: #bbb; }
        .design-dark-mode .announcement-title { color: white; }
        .design-dark-mode .announcement-notice-type { background: var(--secondary-color); color: #121212; font-weight: 700; }
        .design-dark-mode .announcement-content { color: rgba(255, 255, 255, 0.87); }
        .design-dark-mode .announcement-footer { border-top-color: rgba(255, 255, 255, 0.15); }
        .design-dark-mode .signature-name { color: white; }
        .design-dark-mode .signature-title { color: #bbb; }
        .design-dark-mode .announcement-contact { border-top-color: rgba(255, 255, 255, 0.15); color: rgba(255, 255, 255, 0.7); background: #2a2a2a; }
        .design-dark-mode .watermark { color: rgba(255, 255, 255, 0.03); }
        .design-dark-mode .pattern { opacity: 0.03; }

        .design-experimental { font-family: 'Helvetica Neue', Arial, sans-serif; background: white; overflow: hidden; position: relative; box-shadow: none; border: 1px solid #eee; }
        .design-experimental::before { content: ''; position: absolute; top: -150px; right: -150px; width: 350px; height: 350px; border-radius: 50%; background: radial-gradient(circle, rgba(var(--secondary-color-rgb), 0.1), transparent 70%); z-index: 0; }
        .design-experimental::after { content: ''; position: absolute; bottom: -100px; left: -100px; width: 300px; height: 300px; border-radius: 50%; background: radial-gradient(circle, rgba(var(--accent-color-rgb), 0.1), transparent 70%); z-index: 0; }
        .design-experimental .announcement-header { border: none; position: relative; padding-bottom: 30px; margin-bottom: 40px; }
        .design-experimental .announcement-logo { border-radius: 50%; width: 80px; height: 80px; margin-right: 30px; border: 2px solid var(--accent-color); }
        .design-experimental .announcement-org-name { font-size: 22px; font-weight: 800; letter-spacing: 1px; }
        .design-experimental .announcement-title-box { text-align: left; margin: 40px 0; padding-left: 5%; position: relative; border: none; }
        .design-experimental .announcement-title-box::before { content: ''; position: absolute; left: 0; top: 10%; height: 80%; width: 4px; background: var(--primary-color); border-radius: 2px; }
        .design-experimental .announcement-title { font-size: 34px; font-weight: 900; letter-spacing: -1px; line-height: 1.1; margin-bottom: 15px; }
        .design-experimental .announcement-notice-type { background: none; color: var(--secondary-color); font-weight: 700; padding: 0; font-size: 13px; letter-spacing: 2px; position: relative; display: inline-block; margin-bottom: 15px; }
        .design-experimental .announcement-notice-type::after { content: ''; position: absolute; left: 0; bottom: -5px; height: 2px; width: 30px; background: var(--secondary-color); }
        .design-experimental .announcement-content { font-size: 16px; line-height: 1.8; color: #444; padding: 0 5%; }
        .design-experimental .announcement-footer { display: flex; justify-content: flex-end; align-items: flex-end; border-top: 1px dashed #eee; padding-top: 30px; margin-top: 40px; }
        .design-experimental .announcement-contact { margin-top: 40px; padding: 15px; border-top: none; background: var(--primary-color); color: white; text-align: center; border-radius: 0 0 8px 8px; }

        .design-glassmorphic { background: rgba(255, 255, 255, 0.6) !important; backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.25); box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1); border-radius: 15px; overflow: hidden; }
        .design-glassmorphic .announcement-header { background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(5px); border-bottom: 1px solid rgba(255, 255, 255, 0.2); color: var(--primary-color); }
        .design-glassmorphic .announcement-org-name { color: var(--primary-color); }
        .design-glassmorphic .announcement-org-tagline { color: var(--accent-color); }
        .design-glassmorphic .announcement-title { color: var(--primary-color); text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1); }
        .design-glassmorphic .announcement-notice-type { background: rgba(var(--secondary-color-rgb), 0.3); backdrop-filter: blur(4px); border: 1px solid rgba(var(--secondary-color-rgb), 0.4); color: #fff; text-shadow: 1px 1px 2px rgba(0,0,0,0.2); }
        .design-glassmorphic .announcement-content { color: #333; }
        .design-glassmorphic .announcement-footer { border-top: 1px solid rgba(255, 255, 255, 0.2); }
        .design-glassmorphic .announcement-contact { background: rgba(255, 255, 255, 0.1); border-top: 1px solid rgba(255, 255, 255, 0.2); color: var(--accent-color); }
        /* Requires body background for effect */
        body.glassmorphic-active { background-image: url('https://images.unsplash.com/photo-1557683311-eac92134e026?auto=format&fit=crop&q=80&w=2070'); background-size: cover; background-attachment: fixed; }

        .design-neo-brutalism { background: #ffffff; border: 3px solid #000000; box-shadow: 7px 7px 0 #000000; transform: rotate(-0.5deg); transition: all 0.2s ease-in-out; font-family: 'Space Grotesk', monospace; }
        .design-neo-brutalism:hover { transform: rotate(0deg) translateY(-3px); box-shadow: 10px 10px 0 #000000; }
        .design-neo-brutalism .announcement-header { border-bottom: 3px solid #000000; padding: 1.5rem 2rem; }
        .design-neo-brutalism .announcement-logo { border: 2px solid #000; background: #ffcc00; color: #000; font-size: 30px; }
        .design-neo-brutalism .announcement-org-name { font-weight: 700; color: #000; }
        .design-neo-brutalism .announcement-org-tagline { color: #000; font-weight: 500; }
        .design-neo-brutalism .announcement-title { font-weight: 700; font-size: 2.5rem; text-transform: uppercase; letter-spacing: -1px; color: #000000; margin-top: 20px; }
        .design-neo-brutalism .announcement-notice-type { background: #ff4d00; color: #000000; font-weight: 700; padding: 0.4rem 0.8rem; transform: rotate(-2deg); border: 2px solid #000; box-shadow: 3px 3px 0 #000; }
        .design-neo-brutalism .announcement-content { font-size: 16px; }
        .design-neo-brutalism .announcement-footer { border-top: 3px solid #000; }
        .design-neo-brutalism .announcement-contact { background: #00b4d8; color: #000; border-top: 3px solid #000; font-weight: 500; }

        /* --- Layout Styles (Apply to .announcement-container) --- */
        .layout-text-hero .announcement-title-box { min-height: 200px; display: flex; flex-direction: column; justify-content: center; align-items: center; margin: 0 -50px 40px; padding: 50px 40px; background-color: var(--primary-color); position: relative; color: white; text-align: center; border-radius: 0 0 10px 10px; }
        .layout-text-hero .announcement-notice-type { background-color: var(--secondary-color); color: white; }
        .layout-text-hero .announcement-title { color: white; font-size: clamp(2.5rem, 6vw, 4rem); line-height: 1.1; font-weight: 900; margin-bottom: 15px; }
        .layout-text-hero .announcement-date { color: rgba(255, 255, 255, 0.8); font-size: 16px; }

        .layout-asymmetric .announcement { padding: 0; display: grid; grid-template-columns: 1fr 2.5fr; grid-template-rows: auto 1fr auto; grid-template-areas: "header header" "sidebar content" "footer footer"; min-height: auto; /* Override min-height */ }
        .layout-asymmetric .announcement-header { grid-area: header; padding: 40px; margin-bottom: 0; border-bottom: none; }
        .layout-asymmetric .announcement-title-box { grid-area: sidebar; padding: 40px; margin: 0; background-color: var(--primary-color); color: white; display: flex; flex-direction: column; justify-content: center; text-align: left; }
        .layout-asymmetric .announcement-title { color: white; font-size: 28px; }
        .layout-asymmetric .announcement-notice-type { background: var(--secondary-color); }
        .layout-asymmetric .announcement-date { color: rgba(255, 255, 255, 0.8); }
        .layout-asymmetric .announcement-content { grid-area: content; padding: 40px; margin-bottom: 0; background: #fff; }
        .layout-asymmetric .announcement-footer, .layout-asymmetric .announcement-contact { grid-area: footer; padding: 30px 40px; margin-top: 0; border-top: 1px solid var(--border-color); }

        .layout-grid-block .announcement { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 30px; padding: 40px; background: var(--light-color); border-radius: 10px; min-height: auto; }
        .layout-grid-block .announcement-header, .layout-grid-block .announcement-title-box, .layout-grid-block .announcement-content, .layout-grid-block .announcement-footer, .layout-grid-block .announcement-contact { background: white; padding: 25px; border-radius: 8px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); margin: 0 !important; border: none !important; }
        .layout-grid-block .announcement-header { grid-column: 1 / -1; }
        .layout-grid-block .announcement-title-box { grid-column: span 1; }
        .layout-grid-block .announcement-content { grid-column: span 2; }
        .layout-grid-block .announcement-footer { grid-column: 1 / -1; text-align: right; }
        .layout-grid-block .announcement-contact { grid-column: 1 / -1; text-align: center; }

        .layout-magazine .announcement { display: grid; grid-template-columns: 1fr 1.5fr; gap: 40px; padding: 50px; min-height: auto; align-items: start; }
        .layout-magazine .announcement-header { grid-column: 1 / -1; margin-bottom: 0; border-bottom: 1px solid var(--border-color); }
        .layout-magazine .announcement-title-box { grid-column: 1 / 2; padding-right: 30px; border-right: 1px solid var(--border-color); text-align: left; margin: 0; }
        .layout-magazine .announcement-title { font-size: 34px; margin-bottom: 20px; }
        .layout-magazine .announcement-content { grid-column: 2 / -1; padding-left: 30px; margin: 0; }
        .layout-magazine .announcement-footer { grid-column: 1 / -1; border-top: 1px solid var(--border-color); margin-top: 30px; padding-top: 30px; }
        .layout-magazine .announcement-contact { grid-column: 1 / -1; margin-top: 20px; padding-top: 20px; border-top: 1px dashed #ccc; }

        .layout-stacked .announcement { display: flex; flex-direction: column; gap: 0; padding: 0; overflow: hidden; min-height: auto; border-radius: 10px; }
        .layout-stacked .announcement-header { padding: 30px 40px; }
        .layout-stacked .announcement-title-box { position: relative; padding: 50px 40px; background: var(--primary-color); color: white; clip-path: polygon(0 0, 100% 0, 100% 90%, 0 100%); margin: 0; text-align: center; }
        .layout-stacked .announcement-title { font-size: clamp(2.2rem, 5vw, 3.5rem); line-height: 1.1; color: white; margin-bottom: 10px; }
        .layout-stacked .announcement-date { color: rgba(255, 255, 255, 0.8); }
        .layout-stacked .announcement-content { padding: 40px 40px 0; margin-bottom: 0; }
        .layout-stacked .announcement-footer { padding: 30px 40px; margin-top: 0; border-top: none; }
        .layout-stacked .announcement-contact { padding: 20px 40px; margin-top: 0; border-top: 1px dashed #ccc; }

        /* --- Decorative Elements (Apply to .announcement) --- */
        .decoration-organic-shapes { position: relative; overflow: hidden; }
        .decoration-organic-shapes::before { content: ''; position: absolute; top: -80px; right: -100px; width: 250px; height: 250px; border-radius: 42% 58% 70% 30% / 45% 45% 55% 55%; background-color: var(--secondary-color); opacity: 0.06; z-index: 0; }
        .decoration-organic-shapes::after { content: ''; position: absolute; bottom: -100px; left: -80px; width: 220px; height: 220px; border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%; background-color: var(--accent-color); opacity: 0.06; z-index: 0; }
        
        .decoration-geometric { position: relative; overflow: hidden; }
        .decoration-geometric::before { content: ''; position: absolute; top: 50px; right: 50px; width: 80px; height: 80px; background-color: var(--secondary-color); opacity: 0.08; transform: rotate(45deg); z-index: 0; }
        .decoration-geometric::after { content: ''; position: absolute; bottom: 70px; left: 70px; width: 120px; height: 120px; border: 10px solid var(--primary-color); opacity: 0.05; border-radius: 50%; z-index: 0; }
        
        .decoration-3d-elements { position: relative; }
        .decoration-3d-elements .announcement-title-box::before { content: ''; position: absolute; width: 40px; height: 40px; background-color: var(--secondary-color); top: -20px; left: 40px; transform: rotate(45deg) perspective(100px) rotateX(30deg) rotateY(20deg); box-shadow: 5px 5px 10px rgba(0,0,0,0.1); z-index: 0; opacity: 0.15; }
        .decoration-3d-elements .announcement-content::after { content: ''; position: absolute; width: 70px; height: 70px; border-radius: 50%; background: linear-gradient(135deg, var(--primary-color), var(--accent-color)); bottom: 60px; right: 40px; filter: blur(1px); opacity: 0.1; box-shadow: 0 10px 25px rgba(0,0,0,0.1); z-index: 0; }
        
        .decoration-blobs { position: relative; overflow: hidden; }
        .decoration-blobs::before { content: ''; position: absolute; top: -50px; right: -50px; width: 350px; height: 350px; background-color: var(--secondary-color); opacity: 0.04; border-radius: 50%; filter: blur(60px); transform: translate(30%, -30%); z-index: 0; }
        .decoration-blobs::after { content: ''; position: absolute; bottom: -50px; left: -50px; width: 300px; height: 300px; background-color: var(--accent-color); opacity: 0.04; border-radius: 50%; filter: blur(50px); transform: translate(-30%, 30%); z-index: 0; }
        
        .decoration-grid-lines { position: relative; background-image: linear-gradient(to right, rgba(var(--primary-color-rgb), 0.04) 1px, transparent 1px), linear-gradient(to bottom, rgba(var(--primary-color-rgb), 0.04) 1px, transparent 1px); background-size: 30px 30px; }
        
        .decoration-floating-shapes { position: relative; overflow: hidden; }
        .decoration-floating-shapes::before, .decoration-floating-shapes::after { content: ''; position: absolute; width: 250px; height: 250px; background: linear-gradient(45deg, rgba(var(--secondary-color-rgb), 0.05), rgba(var(--accent-color-rgb), 0.05)); border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%; animation: float 18s ease-in-out infinite; z-index: 0; }
        .decoration-floating-shapes::before { top: -120px; right: -120px; }
        .decoration-floating-shapes::after { bottom: -120px; left: -120px; animation-delay: -9s; }
        @keyframes float { 0% { transform: translate(0, 0) rotate(0deg) scale(1); } 25% { transform: translate(40px, 60px) rotate(70deg) scale(1.05); } 50% { transform: translate(-20px, 80px) rotate(150deg) scale(1); } 75% { transform: translate(-50px, 40px) rotate(230deg) scale(0.95); } 100% { transform: translate(0, 0) rotate(360deg) scale(1); } }

        /* Responsive */
        @media (max-width: 1024px) {
            .container {
                flex-direction: column;
                align-items: center; /* Center items when stacked */
            }
            .controls {
                max-width: 840px; /* Allow controls to be wider */
                position: static; /* Unstick controls */
                max-height: none;
                overflow-y: visible;
                margin-bottom: 30px;
            }
            .announcement-preview-area {
                width: 100%;
                min-height: auto;
                padding: 10px;
            }
            .announcement {
                 /* Apply scaling for smaller screens if needed */
                 /* transform: scale(0.9); */
                 /* transform-origin: top center; */
            }
        }

        @media (max-width: 768px) {
            body { padding: 15px; }
            .controls { padding: 20px; }
            .announcement { padding: 30px 35px; min-height: auto; /* Adjust height for mobile */ }
            .announcement-header { flex-direction: column; text-align: center; gap: 15px; }
            .announcement-logo { margin-right: 0; margin-bottom: 15px; width: 80px; height: 80px; font-size: 30px; }
            .announcement-org-name { font-size: 22px; }
            .announcement-title { font-size: 24px; }
            .announcement-content { font-size: 16px; }
            .announcement-footer { align-items: center; }
            .control-row { flex-direction: column; gap: 0; }
             .theme-options {
                 grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
             }
        }

        @media print {
            body { background: none; padding: 0; }
            .container { flex-direction: column; max-width: 100%; gap: 0; }
            .controls { display: none; }
            .announcement-preview-area { padding: 0; background: none; }
            .announcement-container { max-width: 100%; }
            .announcement {
                box-shadow: none;
                transform: none !important;
                border: none;
                width: 210mm; /* Fixed A4 width */
                min-height: 297mm; /* Fixed A4 height */
                padding: 15mm; /* Typical print margins */
                margin: 0;
            }
             .announcement-backdrop { display: none; } /* Hide watermark/pattern for print */
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Control Panel -->
        <div class="controls" id="controlPanel">
            <h2>Announcement Generator</h2>

            <form id="announcementForm" onsubmit="return false;"> <!-- Prevent default submit -->

                <div class="control-group">
                    <label for="templateSelector">Load Template</label>
                    <select id="templateSelector">
                        <option value="custom">Custom (Blank)</option>
                        <option value="event">Event Announcement</option>
                        <option value="meeting">Meeting Notice</option>
                        <option value="achievement">Achievement Announcement</option>
                        <option value="recruitment">Recruitment Notice</option>
                        <option value="workshop">Workshop/Training</option>
                        <option value="competition">Competition Announcement</option>
                        <option value="fundraiser">Fundraising Campaign</option>
                        <option value="holiday">Holiday/Closure Notice</option>
                    </select>
                </div>

                <hr style="border: none; border-top: 1px solid var(--border-color); margin: 25px 0;">

                <div class="control-group">
                    <label for="announcementId">Announcement ID</label>
                    <input type="text" id="announcementId" placeholder="Will be generated automatically" readonly>
                </div>

                <div class="control-group">
                    <label for="orgNameInput">Organization Name</label>
                    <input type="text" id="orgNameInput" value="PRAGATI ASSAM" placeholder="Enter organization name">
                </div>
                <div class="control-group">
                    <label for="orgTaglineInput">Organization Tagline</label>
                    <input type="text" id="orgTaglineInput" value="Empowering Communities Through Culture" placeholder="Enter tagline or slogan">
                </div>
                 <div class="control-group">
                    <label for="languageSelector">Content Language</label>
                    <select id="languageSelector">
                        <option value="en">English</option>
                        <option value="as">অসমীয়া (Assamese)</option>
                        <option value="both">Mix (Handles Both)</option>
                    </select>
                </div>

                 <div class="control-row">
                    <div class="control-group">
                        <label for="logoTextInput">Logo Text</label>
                        <input type="text" id="logoTextInput" placeholder="e.g., PA" value="PA">
                    </div>
                     <div class="control-group">
                        <label for="logoUpload">Logo Image</label>
                        <input type="file" id="logoUpload" accept="image/*">
                    </div>
                </div>

                <hr style="border: none; border-top: 1px solid var(--border-color); margin: 25px 0;">

                <div class="control-group">
                    <label for="noticeTypeInput">Notice Type</label>
                    <select id="noticeTypeInput">
                        <option value="ANNOUNCEMENT">Announcement</option>
                        <option value="NOTICE">Notice</option>
                        <option value="CIRCULAR">Circular</option>
                        <option value="INVITATION">Invitation</option>
                        <option value="IMPORTANT">Important</option>
                        <option value="URGENT">Urgent</option>
                        <option value="REMINDER">Reminder</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="titleInput">Announcement Title</label>
                    <input type="text" id="titleInput" placeholder="Enter announcement title" value="Upcoming Cultural Event">
                </div>
                <div class="control-group">
                    <label for="dateInput">Date of Issue</label>
                    <input type="date" id="dateInput">
                </div>
                <div class="control-group">
                    <label for="contentInput">Announcement Content</label>
                    <textarea id="contentInput" placeholder="Enter the detailed content..." rows="6">We are pleased to announce our upcoming cultural event that will be held on May 15, 2025. The event will showcase traditional performances, art exhibitions, and local cuisine.

All members and interested participants are cordially invited to attend. Please register your interest by April 30, 2025.

For more information, please contact our event coordinator at events@pragatiassam.org or call at +91 9876543210.</textarea>
                </div>

                <hr style="border: none; border-top: 1px solid var(--border-color); margin: 25px 0;">

                <div class="control-group">
                    <label for="signerNameInput">Authorized By (Name)</label>
                    <input type="text" id="signerNameInput" placeholder="Name of authority" value="John Doe">
                </div>
                <div class="control-group">
                    <label for="signerTitleInput">Designation</label>
                    <input type="text" id="signerTitleInput" placeholder="Designation of authority" value="General Secretary">
                </div>
                <div class="control-group">
                    <label for="contactInfoInput">Contact Information</label>
                    <input type="text" id="contactInfoInput" placeholder="e.g., Email | Phone" value="Email: info@pragatiassam.org | Phone: +91 9876543210">
                </div>

                <hr style="border: none; border-top: 1px solid var(--border-color); margin: 25px 0;">
                <h3>Styling Options</h3>
                <br>

                 <div class="control-group">
                    <label>Color Theme</label>
                    <div class="theme-options">
                         <div class="color-option selected" data-theme="classic">
                            <div class="color-preview"><span style="background-color: #2a3b4c;"></span><span style="background-color: #ce8e2c;"></span><span style="background-color: #134e65;"></span></div>
                            <p>Classic</p>
                        </div>
                        <div class="color-option" data-theme="modern">
                             <div class="color-preview"><span style="background-color: #1a2b3c;"></span><span style="background-color: #e94e77;"></span><span style="background-color: #4a90e2;"></span></div>
                            <p>Modern</p>
                        </div>
                        <div class="color-option" data-theme="elegant">
                            <div class="color-preview"><span style="background-color: #5e3a4e;"></span><span style="background-color: #c09f80;"></span><span style="background-color: #76323f;"></span></div>
                            <p>Elegant</p>
                        </div>
                        <div class="color-option" data-theme="minimal">
                            <div class="color-preview"><span style="background-color: #333333;"></span><span style="background-color: #888888;"></span><span style="background-color: #444444;"></span></div>
                            <p>Minimal</p>
                        </div>
                        <div class="color-option" data-theme="vibrant">
                            <div class="color-preview"><span style="background-color: #00204a;"></span><span style="background-color: #f7b633;"></span><span style="background-color: #005792;"></span></div>
                            <p>Vibrant</p>
                        </div>
                        <div class="color-option" data-theme="mocha">
                            <div class="color-preview"><span style="background-color: #6F4E37;"></span><span style="background-color: #B09F7B;"></span><span style="background-color: #483C32;"></span></div>
                            <p>Mocha</p>
                        </div>
                        <div class="color-option" data-theme="neo-brutalist">
                           <div class="color-preview"> <span style="background-color: #000000;"></span><span style="background-color: #ff4d00;"></span><span style="background-color: #00b4d8;"></span></div>
                            <p>Neo Brut</p>
                        </div>
                        <div class="color-option" data-theme="soothing">
                            <div class="color-preview"><span style="background-color: #344e41;"></span><span style="background-color: #a3b18a;"></span><span style="background-color: #588157;"></span></div>
                            <p>Soothing</p>
                        </div>
                    </div>
                </div>

                <div class="control-group">
                    <label>Custom Colors</label>
                    <div class="custom-colors">
                        <div class="color-picker">
                            <label>Primary</label>
                            <input type="color" data-var="--primary-color" data-rgb-var="--primary-color-rgb" value="#2a3b4c">
                        </div>
                        <div class="color-picker">
                            <label>Secondary</label>
                            <input type="color" data-var="--secondary-color" data-rgb-var="--secondary-color-rgb" value="#ce8e2c">
                        </div>
                        <div class="color-picker">
                            <label>Accent</label>
                            <input type="color" data-var="--accent-color" data-rgb-var="--accent-color-rgb" value="#134e65">
                        </div>
                    </div>
                </div>

                <div class="control-group">
                    <label for="designSelector">Design Template</label>
                    <select id="designSelector">
                        <option value="standard">Standard</option>
                        <option value="formal">Formal</option>
                        <option value="modern">Modern</option>
                        <option value="creative">Creative</option>
                        <option value="minimalist">Minimalist</option>
                        <option value="brutalist">Brutalist</option>
                        <option value="dark-mode">Dark Mode</option>
                        <option value="experimental">Experimental</option>
                        <option value="glassmorphic">Glassmorphic</option>
                        <option value="neo-brutalism">Neo-Brutalism</option>
                    </select>
                </div>

                <div class="control-group">
                    <label for="layoutSelector">Layout Style</label>
                    <select id="layoutSelector">
                        <option value="standard">Standard</option>
                        <option value="text-hero">Text Hero</option>
                        <option value="asymmetric">Asymmetric Sidebar</option>
                        <option value="grid-block">Grid Blocks</option>
                        <option value="magazine">Magazine</option>
                        <option value="stacked">Stacked Sections</option>
                    </select>
                </div>

                <div class="control-group">
                    <label for="fontStyleSelector">Typography Style</label>
                    <select id="fontStyleSelector">
                        <option value="default">Default (Montserrat/Cormorant)</option>
                        <option value="classic-serif">Classic Serif (Times/Georgia)</option>
                        <option value="modern-sans">Modern Sans (Helvetica/Roboto)</option>
                        <option value="elegant-script">Elegant Script (Great Vibes/Cormorant)</option>
                        <option value="bold-impact">Bold Impact (Impact/Montserrat)</option>
                        <option value="minimal-clean">Minimal Clean (Raleway/Open Sans)</option>
                        <option value="dynamic">Dynamic Sizing</option>
                    </select>
                </div>

                 <div class="control-group">
                    <label for="textEffectSelector">Title Effect</label>
                    <select id="textEffectSelector">
                        <option value="none">None</option>
                        <option value="shadow">Shadow</option>
                        <option value="outline">Outline</option>
                        <option value="gradient">Gradient Text</option>
                        <option value="highlight">Highlight BG</option>
                        <option value="underline">Decor Underline</option>
                        <option value="maximalist">Maximalist</option>
                        <option value="distorted">Distorted Wave</option>
                        <option value="layered">Layered</option>
                    </select>
                </div>

                <div class="control-group">
                    <label for="iconSelector">Add Icon to Title</label>
                    <select id="iconSelector">
                        <option value="none">None</option>
                        <option value="info">Info</option>
                        <option value="alert">Alert</option>
                        <option value="event">Event</option>
                        <option value="award">Award</option>
                        <option value="calendar">Calendar</option>
                        <option value="mail">Mail</option>
                    </select>
                </div>

                 <div class="control-group">
                    <label for="backgroundType">Background Style</label>
                     <div class="control-row">
                        <select id="backgroundType" style="flex-grow: 1;">
                            <option value="solid" selected>Solid Color</option>
                            <option value="gradient">Subtle Gradient</option>
                            <option value="gradient-pastel">Pastel Gradient</option>
                            <option value="gradient-vibrant">Vibrant Gradient</option>
                            <option value="gradient-corporate">Corporate Gradient</option>
                        </select>
                        <input type="color" id="backgroundColorInput" value="#ffffff" title="Solid Background Color">
                    </div>
                </div>

                <div class="control-group">
                    <label for="backgroundPattern">Background Pattern (Subtle)</label>
                    <select id="backgroundPattern">
                        <option value="none">None</option>
                        <option value="dots">Dots</option>
                        <option value="lines">Lines</option>
                        <option value="grid">Grid</option>
                        <option value="circles">Circles</option>
                        <option value="waves">Waves</option>
                    </select>
                </div>

                <div class="control-group">
                    <div class="toggle-switch-container">
                        <label for="imageOverlayToggle">Enable Background Image Overlay</label>
                        <div class="toggle-switch">
                            <input type="checkbox" id="imageOverlayToggle">
                            <label for="imageOverlayToggle"></label>
                        </div>
                    </div>
                </div>

                <div class="control-group image-overlay-controls" style="display: none;">
                    <label for="overlayImageUpload">Overlay Image</label>
                    <input type="file" id="overlayImageUpload" accept="image/*">
                    <div class="range-control">
                        <label for="overlayOpacity">Opacity</label>
                        <input type="range" id="overlayOpacity" min="0.05" max="0.9" step="0.05" value="0.2">
                        <span class="range-value">0.20</span>
                    </div>
                </div>

                <div class="control-group">
                    <label for="accentElementSelector">Accent Elements (Applied to Page)</label>
                    <select id="accentElementSelector">
                        <option value="none">None</option>
                        <option value="corner-ribbon">Corner Ribbon</option>
                        <option value="side-border">Side Border</option>
                        <option value="top-bottom-bars">Top/Bottom Bars</option>
                        <option value="decorative-corners">Decorative Corners</option>
                        <option value="paper-effect">Paper Effect Shadow</option>
                    </select>
                </div>

                <div class="control-group">
                    <label for="decorationSelector">Decorative BG Elements</label>
                    <select id="decorationSelector">
                        <option value="none">None</option>
                        <option value="organic-shapes">Organic Shapes</option>
                        <option value="geometric">Geometric</option>
                        <option value="3d-elements">3D Elements</option>
                        <option value="blobs">Blurred Blobs</option>
                        <option value="grid-lines">Grid Lines (Alt)</option>
                        <option value="floating-shapes">Floating Shapes</option>
                    </select>
                </div>

                <div class="control-actions">
                    <button id="generateButton" class="button">
                        <span style="margin-right: 5px;">⟳</span> Update Preview
                    </button>
                    <button id="exportPdfButton" class="button">
                        <span style="margin-right: 5px;">📄</span> Export PDF
                    </button>
                    <button id="exportImageButton" class="button">
                        <span style="margin-right: 5px;">🖼️</span> Export Image
                    </button>
                    <button id="exportOptionsButton" class="button button-secondary">
                        <span style="margin-right: 5px;">↗</span> More Options
                    </button>
                    <button id="saveLoadButton" class="button button-secondary">
                        <span style="margin-right: 5px;">💾</span> Save/Load
                    </button>
                </div>
                
                <!-- Export Options Panel -->
                <div id="exportOptionsPanel" style="display: none; margin-top: 15px; padding: 15px; background: rgba(0,0,0,0.03); border-radius: 6px;">
                    <h3>Export Options</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px; margin-top: 10px;">
                        <div class="export-option" style="background: white; border: 1px solid var(--border-color); border-radius: 4px; padding: 10px; text-align: center; cursor: pointer;" id="exportJpgButton">
                            <div style="font-size: 24px; margin-bottom: 5px; color: var(--primary-color);">📸</div>
                            <div style="font-size: 12px; font-weight: 500;">JPG Format</div>
                        </div>
                        <div class="export-option" style="background: white; border: 1px solid var(--border-color); border-radius: 4px; padding: 10px; text-align: center; cursor: pointer;" id="exportHtmlButton">
                            <div style="font-size: 24px; margin-bottom: 5px; color: var(--primary-color);">📝</div>
                            <div style="font-size: 12px; font-weight: 500;">HTML File</div>
                        </div>
                        <div class="export-option" style="background: white; border: 1px solid var(--border-color); border-radius: 4px; padding: 10px; text-align: center; cursor: pointer;" id="printButton">
                            <div style="font-size: 24px; margin-bottom: 5px; color: var(--primary-color);">🖨️</div>
                            <div style="font-size: 12px; font-weight: 500;">Print</div>
                        </div>
                        <div class="export-option" style="background: white; border: 1px solid var(--border-color); border-radius: 4px; padding: 10px; text-align: center; cursor: pointer;" id="shareButton">
                            <div style="font-size: 24px; margin-bottom: 5px; color: var(--primary-color);">🔗</div>
                            <div style="font-size: 12px; font-weight: 500;">Share Link</div>
                        </div>
                    </div>
                    
                    <div class="control-group" style="margin-top: 15px;">
                        <label for="exportQualitySlider">Export Quality</label>
                        <input type="range" id="exportQualitySlider" min="1" max="2" step="0.1" value="1.5">
                        <div style="display: flex; justify-content: space-between; font-size: 12px;">
                            <span>Lower</span>
                            <span>Higher</span>
                        </div>
                    </div>
                </div>
                
                <!-- Save/Load Panel -->
                <div id="saveLoadPanel" class="save-load-panel" style="display: none; margin-top: 15px; padding: 15px; background: rgba(0,0,0,0.03); border-radius: 6px;">
                    <h3>Save/Load Announcements</h3>
                    <div class="control-group">
                        <label for="saveNameInput">Save Current Announcement</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="text" id="saveNameInput" placeholder="Enter a name to save" style="flex: 1;">
                            <button id="saveButton" class="button" style="white-space: nowrap;">Save</button>
                        </div>
                    </div>
                    
                    <h4 style="margin-top: 15px; margin-bottom: 5px;">Saved Announcements</h4>
                    <div id="savedAnnouncementsList" style="max-height: 150px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 4px; background: white;">
                        <!-- Saved announcements will be listed here dynamically -->
                        <div class="saved-announcement-item" style="padding: 8px 12px; border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center;">
                            <span class="saved-announcement-title" style="font-weight: 500;">No saved announcements yet</span>
                        </div>
                    </div>
                </div>
            </form>
        </div>

        <!-- Announcement Preview -->
        <div class="announcement-preview-area">
            <div class="announcement-container" id="announcementContainer">
                <div class="announcement" id="announcementPreview">
                    <!-- Background Elements -->
                    <div class="announcement-backdrop">
                        <div class="watermark" id="watermarkText">PRAGATI ASSAM</div>
                        <div class="pattern" id="backgroundPatternElement"></div>
                    </div>

                    <!-- Header -->
                    <div class="announcement-header">
                        <div class="announcement-logo" id="announcementLogo">PA</div>
                        <div class="announcement-org">
                            <div class="announcement-org-name" id="orgName">PRAGATI ASSAM</div>
                            <div class="announcement-org-tagline" id="orgTagline">Empowering Communities Through Culture</div>
                        </div>
                    </div>

                    <!-- Title Section -->
                    <div class="announcement-title-box">
                        <div class="announcement-notice-type" id="noticeType">ANNOUNCEMENT</div>
                        <h1 class="announcement-title" id="announcementTitle" data-title="Upcoming Cultural Event">Upcoming Cultural Event</h1>
                        <div class="announcement-date" id="announcementDate">Date: April 7, 2025</div>
                    </div>

                    <!-- Main Content -->
                    <div class="announcement-content" id="announcementContent">
                        We are pleased to announce our upcoming cultural event that will be held on May 15, 2025. The event will showcase traditional performances, art exhibitions, and local cuisine.

All members and interested participants are cordially invited to attend. Please register your interest by April 30, 2025.

For more information, please contact our event coordinator at events@pragatiassam.org or call at +91 9876543210.
                    </div>

                    <!-- Footer -->
                    <div class="announcement-footer">
                        <div class="announcement-signature">
                            <!-- Signature Image Placeholder -->
                            <!-- <img class="signature-img" src="path/to/signature.png" alt="Signature"> -->
                            <div class="signature-name" id="signerName">John Doe</div>
                            <div class="signature-title" id="signerTitle">General Secretary</div>
                        </div>
                    </div>

                    <!-- Contact Information -->
                    <div class="announcement-contact" id="contactInfo">
                        Email: info@pragatiassam.org | Phone: +91 9876543210
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Toast Notification -->
    <div id="toastNotification" style="position: fixed; bottom: 20px; right: 20px; background: var(--primary-color); color: white; padding: 12px 20px; border-radius: 6px; box-shadow: 0 3px 10px rgba(0,0,0,0.1); transform: translateY(100px); opacity: 0; transition: all 0.3s ease; z-index: 1000; display: flex; align-items: center; gap: 10px;">
        <span class="toast-icon" style="font-size: 18px;">✓</span>
        <span class="toast-message">Action completed successfully</span>
        <span class="toast-close" style="cursor: pointer; font-size: 16px;">×</span>
    </div>

    <script>
        // Initialize jsPDF
        window.jsPDF = window.jspdf.jsPDF;

        // --- DOM Elements --- 
        const elements = {
            // Inputs
            announcementId: document.getElementById('announcementId'),
            orgNameInput: document.getElementById('orgNameInput'),
            orgTaglineInput: document.getElementById('orgTaglineInput'),
            noticeTypeInput: document.getElementById('noticeTypeInput'),
            titleInput: document.getElementById('titleInput'),
            contentInput: document.getElementById('contentInput'),
            signerNameInput: document.getElementById('signerNameInput'),
            signerTitleInput: document.getElementById('signerTitleInput'),
            contactInfoInput: document.getElementById('contactInfoInput'),
            languageSelector: document.getElementById('languageSelector'),
            dateInput: document.getElementById('dateInput'),
            logoTextInput: document.getElementById('logoTextInput'),
            logoUpload: document.getElementById('logoUpload'),
            backgroundPattern: document.getElementById('backgroundPattern'),
            backgroundColorInput: document.getElementById('backgroundColorInput'),
            backgroundType: document.getElementById('backgroundType'),
            textEffectSelector: document.getElementById('textEffectSelector'),
            iconSelector: document.getElementById('iconSelector'),
            imageOverlayToggle: document.getElementById('imageOverlayToggle'),
            overlayImageUpload: document.getElementById('overlayImageUpload'),
            overlayOpacity: document.getElementById('overlayOpacity'),
            accentElementSelector: document.getElementById('accentElementSelector'),
            fontStyleSelector: document.getElementById('fontStyleSelector'),
            designSelector: document.getElementById('designSelector'),
            layoutSelector: document.getElementById('layoutSelector'),
            decorationSelector: document.getElementById('decorationSelector'),
            templateSelector: document.getElementById('templateSelector'),
            
            // Preview Elements
            orgName: document.getElementById('orgName'),
            orgTagline: document.getElementById('orgTagline'),
            noticeType: document.getElementById('noticeType'),
            announcementTitle: document.getElementById('announcementTitle'),
            announcementDate: document.getElementById('announcementDate'),
            announcementContent: document.getElementById('announcementContent'),
            signerName: document.getElementById('signerName'),
            signerTitle: document.getElementById('signerTitle'),
            contactInfo: document.getElementById('contactInfo'),
            watermarkText: document.getElementById('watermarkText'),
            announcementLogo: document.getElementById('announcementLogo'),
            backgroundPatternElement: document.getElementById('backgroundPatternElement'),
            announcementPreview: document.getElementById('announcementPreview'),
            announcementContainer: document.getElementById('announcementContainer'),

            // Other Controls
            imageOverlayControls: document.querySelector('.image-overlay-controls'),
            overlayOpacityValue: document.querySelector('.image-overlay-controls .range-value'),
            printBtn: document.getElementById('printBtn'),
            exportPdfBtn: document.getElementById('exportPdfBtn'),
            exportImgBtn: document.getElementById('exportImgBtn'),
            themeOptions: document.querySelectorAll('.color-option'),
            customColorPickers: document.querySelectorAll('.custom-colors input[type="color"]'),

            // New Elements
            generateButton: document.getElementById('generateButton'),
            exportPdfButton: document.getElementById('exportPdfButton'),
            exportImageButton: document.getElementById('exportImageButton'),
            exportOptionsButton: document.getElementById('exportOptionsButton'),
            saveLoadButton: document.getElementById('saveLoadButton'),
            exportOptionsPanel: document.getElementById('exportOptionsPanel'),
            exportJpgButton: document.getElementById('exportJpgButton'),
            exportHtmlButton: document.getElementById('exportHtmlButton'),
            printButton: document.getElementById('printButton'),
            shareButton: document.getElementById('shareButton'),
            exportQualitySlider: document.getElementById('exportQualitySlider'),
            saveLoadPanel: document.getElementById('saveLoadPanel'),
            saveButton: document.getElementById('saveButton'),
            loadButton: document.getElementById('loadButton'),
            announcementList: document.getElementById('announcementList'),
            toastContainer: document.getElementById('toastContainer')
        };

        const bodyElement = document.body;

        // --- Templates --- 
        const templates = {
             custom: { title: '', content: '' },
             event: { title: 'Upcoming Event Announcement', content: 'We are excited to announce an upcoming event!\n\nDate: [Insert Date]\nTime: [Insert Time]\nLocation: [Insert Location]\n\nDetails: [Add more details about the event here.]\n\nWe look forward to seeing you there!' },
             meeting: { title: 'Meeting Notice', content: 'Please be advised that the next [Committee/Team Name] meeting will be held as follows:\n\nDate: [Insert Date]\nTime: [Insert Time]\nLocation: [Insert Location/Platform]\n\nAgenda:\n1. [Agenda Item 1]\n2. [Agenda Item 2]\n3. [Agenda Item 3]\n\nPlease confirm your attendance by [RSVP Date].' },
             achievement: { title: 'Achievement Announcement', content: 'We are proud to announce a significant achievement!\n\n[Describe the achievement, e.g., successful project completion, award received, milestone reached.]\n\nThis success was made possible by the hard work and dedication of [mention relevant individuals or teams].\n\nCongratulations to everyone involved!' },
             recruitment: { title: 'Recruitment Notice / Job Opening', content: 'We are currently seeking qualified candidates for the position of [Job Title].\n\nPosition: [Job Title]\nDepartment: [Department Name]\nLocation: [Location]\n\nResponsibilities include:\n- [Responsibility 1]\n- [Responsibility 2]\n\nQualifications:\n- [Qualification 1]\n- [Qualification 2]\n\nInterested candidates should submit their application/resume by [Application Deadline] to [Email Address or Application Link].' },
             workshop: { title: 'Workshop/Training Announcement', content: 'Announcing an upcoming Workshop/Training session:\n\nTopic: [Workshop Topic]\nDate: [Insert Date]\nTime: [Insert Time]\nDuration: [Duration]\nLocation/Platform: [Insert Location/Platform]\nInstructor/Facilitator: [Name]\n\nThis session will cover [brief description of content].\n\nRegistration Deadline: [Registration Deadline]\nRegister here: [Registration Link/Contact]' },
             competition: { title: 'Competition Announcement', content: 'Get ready for the [Competition Name]!\n\nWe invite all eligible participants to join our upcoming competition.\n\nEvent: [Competition Name]\nDate(s): [Insert Date(s)]\nTime: [Insert Time]\nVenue: [Insert Venue]\n\nCategories/Rules: [Provide details or link to rules]\n\nPrizes: [List prizes or mention prize categories]\n\nRegistration closes on [Registration Deadline]. Register at [Registration Link/Contact].' },
             fundraiser: { title: 'Fundraising Campaign Launch', content: 'We are launching a fundraising campaign to support [Cause/Project Name].\n\nOur Goal: [Fundraising Goal Amount]\nCampaign Duration: [Start Date] to [End Date]\n\nFunds raised will be used for [explain how funds will be used].\n\nYour contribution, big or small, will make a difference.\n\nDonate here: [Donation Link]\nLearn more: [Link to more information]' },
             holiday: { title: 'Holiday / Office Closure Notice', content: 'Please note that our office/organization will be closed on the following date(s) in observance of [Holiday Name]:\n\nClosure Date(s): [Insert Date(s)]\n\nNormal operations will resume on [Resumption Date].\n\nWe wish everyone a happy and safe holiday!' }
         };

        // --- Helper Functions --- 
        function hexToRgb(hex) {
             const bigint = parseInt(hex.slice(1), 16);
             const r = (bigint >> 16) & 255;
             const g = (bigint >> 8) & 255;
             const b = bigint & 255;
             return `${r}, ${g}, ${b}`;
         }

        function applyClassPrefix(element, prefix, value) {
            // Remove existing classes with the prefix
            const classesToRemove = [];
            element.classList.forEach(cls => {
                if (cls.startsWith(prefix + '-')) {
                    classesToRemove.push(cls);
                }
            });
            element.classList.remove(...classesToRemove);
            
            // Add new class if value is not none/default
            if (value && value !== 'none' && value !== 'default' && value !== 'standard') {
                element.classList.add(`${prefix}-${value}`);
            }
        }

        // --- Core Update Logic --- 
        function updateAnnouncement() {
            // Get text values
            const orgName = elements.orgNameInput.value || 'Organization Name';
            const orgTagline = elements.orgTaglineInput.value || 'Tagline goes here';
            const noticeType = elements.noticeTypeInput.value || 'ANNOUNCEMENT';
            const title = elements.titleInput.value || 'Announcement Title';
            const content = elements.contentInput.value || 'Announcement content goes here...';
            const signerName = elements.signerNameInput.value || 'Signer Name';
            const signerTitle = elements.signerTitleInput.value || 'Signer Title';
            const contactInfo = elements.contactInfoInput.value || 'Contact Info';
            const language = elements.languageSelector.value;
            const logoText = elements.logoTextInput.value || orgName.substring(0, 2).toUpperCase() || 'LG';
            
            // Generate or keep announcement ID
            if (!elements.announcementId.value) {
                elements.announcementId.value = generateAnnouncementId();
            }

            // Update Text Content
            elements.orgName.textContent = orgName;
            elements.orgTagline.textContent = orgTagline;
            elements.noticeType.textContent = noticeType;
            elements.announcementTitle.textContent = title;
            elements.announcementTitle.dataset.title = title; // For layered effect
            elements.announcementContent.textContent = content;
            elements.signerName.textContent = signerName;
            elements.signerTitle.textContent = signerTitle;
            elements.contactInfo.textContent = contactInfo;
            elements.watermarkText.textContent = orgName;

            // Update Date
            let dateValue = elements.dateInput.value;
            const dateOptions = { year: 'numeric', month: 'long', day: 'numeric' };
            const locale = language === 'as' ? 'as-IN' : 'en-US';
            if (dateValue) {
                try {
                    const dateObj = new Date(dateValue + 'T00:00:00'); // Add time to avoid timezone issues
                    dateValue = dateObj.toLocaleDateString(locale, dateOptions);
                } catch (e) {
                    console.error("Error parsing date:", e);
                    dateValue = new Date().toLocaleDateString(locale, dateOptions); // Fallback
                }
            } else {
                dateValue = new Date().toLocaleDateString(locale, dateOptions);
            }
            elements.announcementDate.textContent = `Date: ${dateValue}`;

            // Apply Language Class (Affects Font)
            [elements.orgName, elements.orgTagline, elements.noticeType, elements.announcementTitle, 
             elements.announcementContent, elements.signerName, elements.signerTitle, elements.contactInfo]
            .forEach(el => {
                el.classList.remove('assamese-text');
                if (language === 'as' || language === 'both') {
                    el.classList.add('assamese-text');
                }
            });

            // Update Logo (Text or Image)
            if (!elements.logoUpload.files || !elements.logoUpload.files[0]) { // If no file is selected
                elements.announcementLogo.innerHTML = logoText; // Use text
                 // Reset potential background from image loading
                elements.announcementLogo.style.background = ''; 
                elements.announcementLogo.classList.remove('has-image');
            } else if (!elements.announcementLogo.classList.contains('has-image')){
                // File selected, but image not loaded yet (handled by handleLogoUpload)
                elements.announcementLogo.innerHTML = ''; // Clear text while loading
            }
            // Ensure transparency is handled correctly elsewhere (e.g., after image load)

            // --- Apply Styles --- 
            applyClassPrefix(elements.announcementPreview, 'design', elements.designSelector.value);
            applyClassPrefix(elements.announcementContainer, 'layout', elements.layoutSelector.value);
            applyClassPrefix(elements.announcementPreview, 'font', elements.fontStyleSelector.value);
            applyClassPrefix(elements.announcementTitleBox || elements.announcementTitle, 'text-effect', elements.textEffectSelector.value); // Apply effect to title or its box
            applyClassPrefix(elements.backgroundPatternElement, 'pattern', elements.backgroundPattern.value);
            applyClassPrefix(elements.announcementPreview, 'decoration', elements.decorationSelector.value);
            applyClassPrefix(bodyElement, 'accent', elements.accentElementSelector.value); // Accent on body

            applyIcon(elements.iconSelector.value);
            applyBackground();
            applyImageOverlay();
            
            // Special body class for glassmorphism
            if (elements.designSelector.value === 'glassmorphic') {
                bodyElement.classList.add('glassmorphic-active');
            } else {
                bodyElement.classList.remove('glassmorphic-active');
            }
        }

        // --- Style Application Functions --- 
        function applyIcon(iconClass) {
            let iconSpan = elements.announcementTitle.querySelector('.icon');
            if (iconSpan) {
                iconSpan.remove();
            }
            if (iconClass !== 'none') {
                iconSpan = document.createElement('span');
                iconSpan.className = `icon icon-${iconClass}`;
                elements.announcementTitle.insertBefore(iconSpan, elements.announcementTitle.firstChild);
            }
        }

        function applyBackground() {
            const type = elements.backgroundType.value;
            const color = elements.backgroundColorInput.value;
            const preview = elements.announcementPreview;

            // Remove existing gradient classes first
            const gradientClasses = ['bg-gradient', 'bg-gradient-pastel', 'bg-gradient-vibrant', 'bg-gradient-corporate'];
            preview.classList.remove(...gradientClasses);
            preview.style.backgroundImage = ''; // Clear inline gradient styles

            if (type === 'solid') {
                preview.style.backgroundColor = color;
            } else {
                preview.style.backgroundColor = ''; // Ensure solid color is removed
                // Add the specific gradient class (e.g., bg-gradient-pastel)
                preview.classList.add(`bg-${type}`); 
            }
        }

        function applyImageOverlay() {
            const preview = elements.announcementPreview;
            if (elements.imageOverlayToggle.checked && elements.overlayImageUpload.files && elements.overlayImageUpload.files[0]) {
                // Image is selected and toggle is on - FileReader handles this in its own listener
                elements.imageOverlayControls.style.display = 'block';
                // Update opacity immediately if slider changes
                preview.style.setProperty('--overlay-opacity', elements.overlayOpacity.value);
                elements.overlayOpacityValue.textContent = parseFloat(elements.overlayOpacity.value).toFixed(2);
                preview.classList.add('announcement-with-image-overlay'); // Ensure class is added
            } else {
                // Toggle is off or no image selected
                preview.classList.remove('announcement-with-image-overlay');
                preview.style.removeProperty('--overlay-image');
                preview.style.removeProperty('--overlay-opacity');
                elements.imageOverlayControls.style.display = elements.imageOverlayToggle.checked ? 'block' : 'none';
            }
        }

        function handleLogoUpload(event) {
            const logoEl = elements.announcementLogo;
            if (event.target.files && event.target.files[0]) {
                const file = event.target.files[0];
                // Check file size (limit to 5MB)
                if (file.size > 5 * 1024 * 1024) {
                    showToast('Logo image is too large. Please use an image under 5MB.', 'error');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    // Create the inner container and image structure
                    logoEl.innerHTML = `<div class="logo-container"><img src="${e.target.result}" alt="Organization Logo"></div>`;
                    logoEl.style.background = 'transparent'; // Ensure background is transparent
                    logoEl.classList.add('has-image'); // Mark that image is loaded
                    
                    // Preload image to ensure it loads properly
                    const img = new Image();
                    img.onload = function() {
                        // Image loaded successfully
                    };
                    img.onerror = function() {
                        // Image failed to load
                        showToast('Failed to load image. Please try another file.', 'error');
                        logoEl.innerHTML = elements.logoTextInput.value || 'PA';
                        logoEl.classList.remove('has-image');
                    };
                    img.src = e.target.result;
                };
                reader.onerror = function() {
                    console.error("Error reading logo file.");
                    logoEl.innerHTML = elements.logoTextInput.value || 'PA'; // Show fallback text
                    logoEl.style.background = '';
                    logoEl.classList.remove('has-image');
                    showToast('Failed to read image file. Please try again.', 'error');
                }
                logoEl.innerHTML = ''; // Clear placeholder while loading
                reader.readAsDataURL(file);
            } else {
                // No file selected, revert to text (handled in updateAnnouncement)
                logoEl.classList.remove('has-image');
                logoEl.innerHTML = elements.logoTextInput.value || 'PA';
                updateAnnouncement(); // Update the preview
                updateAnnouncement(); // Re-run to show text logo
            }
        }

        function applyTheme(theme) {
            const themeColors = {
                 classic: { primary: '#2a3b4c', secondary: '#ce8e2c', accent: '#134e65' },
                 modern: { primary: '#1a2b3c', secondary: '#e94e77', accent: '#4a90e2' },
                 elegant: { primary: '#5e3a4e', secondary: '#c09f80', accent: '#76323f' },
                 minimal: { primary: '#333333', secondary: '#888888', accent: '#444444' },
                 vibrant: { primary: '#00204a', secondary: '#f7b633', accent: '#005792' },
                 mocha: { primary: '#6F4E37', secondary: '#B09F7B', accent: '#483C32' },
                 'neo-brutalist': { primary: '#000000', secondary: '#ff4d00', accent: '#00b4d8' },
                 soothing: { primary: '#344e41', secondary: '#a3b18a', accent: '#588157' }
            };

            if (themeColors[theme]) {
                const colors = themeColors[theme];
                const root = document.documentElement;
                
                root.style.setProperty('--primary-color', colors.primary);
                root.style.setProperty('--secondary-color', colors.secondary);
                root.style.setProperty('--accent-color', colors.accent);

                const primaryRgb = hexToRgb(colors.primary);
                const secondaryRgb = hexToRgb(colors.secondary);
                const accentRgb = hexToRgb(colors.accent);

                root.style.setProperty('--primary-color-rgb', primaryRgb);
                root.style.setProperty('--secondary-color-rgb', secondaryRgb);
                root.style.setProperty('--accent-color-rgb', accentRgb);

                // Update custom color pickers
                document.querySelector('.custom-colors input[data-var="--primary-color"]').value = colors.primary;
                document.querySelector('.custom-colors input[data-var="--secondary-color"]').value = colors.secondary;
                document.querySelector('.custom-colors input[data-var="--accent-color"]').value = colors.accent;

                updateAnnouncement(); // Refresh preview with new theme colors
            }
        }

        function applyTemplate(templateKey) {
            if (templates[templateKey]) {
                elements.titleInput.value = templates[templateKey].title;
                elements.contentInput.value = templates[templateKey].content;
                updateAnnouncement();
            }
        }

        // --- Export Functions --- 
        function exportToPDF() {
            const element = elements.announcementPreview;
            const title = elements.announcementTitle.textContent || 'announcement';
            const filename = `${title.replace(/\s+/g, '_').toLowerCase()}.pdf`;
            
            html2canvas(element, {
                scale: 2, // Higher scale for better quality
                useCORS: true,
                logging: false,
                width: element.offsetWidth, // Ensure correct width
                height: element.offsetHeight // Ensure correct height
            }).then(canvas => {
                const imgData = canvas.toDataURL('image/jpeg', 0.98); // Use high quality JPEG
                
                const pdf = new jsPDF({
                    orientation: 'portrait',
                    unit: 'mm',
                    format: 'a4' // Standard A4 format
                });
                
                const pdfWidth = pdf.internal.pageSize.getWidth();
                const pdfHeight = pdf.internal.pageSize.getHeight();
                const canvasWidth = canvas.width;
                const canvasHeight = canvas.height;
                const ratio = Math.min(pdfWidth / canvasWidth, pdfHeight / canvasHeight);

                // Calculate the dimensions maintaining aspect ratio
                const imgWidth = canvasWidth * ratio;
                const imgHeight = canvasHeight * ratio;

                 // Center the image on the PDF page (optional)
                 const xPos = (pdfWidth - imgWidth) / 2;
                 const yPos = (pdfHeight - imgHeight) / 2;

                // pdf.addImage(imgData, 'JPEG', 0, 0, pdfWidth, pdfHeight); // Stretches image
                pdf.addImage(imgData, 'JPEG', xPos, yPos, imgWidth, imgHeight);
                
                pdf.save(filename);
            }).catch(error => {
                console.error('Error generating PDF:', error);
                alert('Error generating PDF. Check console for details.');
            });
        }

        function exportToImage() {
            const element = elements.announcementPreview;
            const title = elements.announcementTitle.textContent || 'announcement';
            const filename = `${title.replace(/\s+/g, '_').toLowerCase()}.png`;
            
            html2canvas(element, {
                scale: 2,
                useCORS: true,
                logging: false,
                backgroundColor: null // Use element background or make transparent if needed
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = filename;
                link.href = canvas.toDataURL('image/png');
                link.click();
            }).catch(error => {
                console.error('Error generating Image:', error);
                alert('Error generating Image. Check console for details.');
            });
        }
        
        // --- Utility Functions ---
        function generateAnnouncementId() {
            return 'pa-' + Math.random().toString(36).substring(2, 9) + 
                   '-' + new Date().getTime().toString(36);
        }
        
        function showToast(message, icon = '✓', isError = false) {
            const toast = document.getElementById('toastNotification');
            const toastIcon = toast.querySelector('.toast-icon');
            const toastMessage = toast.querySelector('.toast-message');
            
            toastIcon.textContent = icon;
            toastMessage.textContent = message;
            
            if (isError) {
                toast.style.background = '#e74c3c';
            } else {
                toast.style.background = '';
            }
            
            toast.classList.add('visible');
            toast.style.transform = 'translateY(0)';
            toast.style.opacity = '1';
            
            // Hide the toast after 3 seconds
            setTimeout(() => {
                toast.style.transform = 'translateY(100px)';
                toast.style.opacity = '0';
            }, 3000);
        }
        
        // --- Save/Load Functions ---
        function getCurrentAnnouncementData() {
            // Collect all data from the form
            return {
                id: elements.announcementId.value,
                orgName: elements.orgNameInput.value,
                orgTagline: elements.orgTaglineInput.value,
                noticeType: elements.noticeTypeInput.value,
                title: elements.titleInput.value,
                date: elements.dateInput.value,
                content: elements.contentInput.value,
                signerName: elements.signerNameInput.value,
                signerTitle: elements.signerTitleInput.value,
                contactInfo: elements.contactInfoInput.value,
                language: elements.languageSelector.value,
                logoText: elements.logoTextInput.value,
                
                // Save timestamp
                savedAt: new Date().toISOString()
            };
        }
        
        function saveAnnouncement(name, data, silent = false) {
            if (!name && !silent) {
                showToast('Please enter a name for your announcement', '⚠️');
                return;
            }
            
            // Get existing saved announcements
            let savedAnnouncements = JSON.parse(localStorage.getItem('pragatiAnnouncements') || '{}');
            
            // If no name provided, use the ID as the key
            const key = name || data.id;
            
            // Save the data
            savedAnnouncements[key] = data;
            localStorage.setItem('pragatiAnnouncements', JSON.stringify(savedAnnouncements));
            
            // Update the list if not silent
            if (!silent) {
                updateSavedAnnouncementsList();
                showToast('Announcement saved successfully!');
            }
        }
        
        function loadAnnouncement(key) {
            const savedAnnouncements = JSON.parse(localStorage.getItem('pragatiAnnouncements') || '{}');
            const data = savedAnnouncements[key];
            
            if (!data) {
                showToast('Could not find the saved announcement', '⚠️');
                return;
            }
            
            // Populate form fields with saved data
            elements.announcementId.value = data.id;
            elements.orgNameInput.value = data.orgName || '';
            elements.orgTaglineInput.value = data.orgTagline || '';
            elements.noticeTypeInput.value = data.noticeType || 'ANNOUNCEMENT';
            elements.titleInput.value = data.title || '';
            elements.dateInput.value = data.date || '';
            elements.contentInput.value = data.content || '';
            elements.signerNameInput.value = data.signerName || '';
            elements.signerTitleInput.value = data.signerTitle || '';
            elements.contactInfoInput.value = data.contactInfo || '';
            elements.languageSelector.value = data.language || 'en';
            elements.logoTextInput.value = data.logoText || '';
            
            // Update the preview
            updateAnnouncement();
            showToast('Announcement loaded successfully!');
        }
        
        function deleteAnnouncement(key) {
            if (confirm('Are you sure you want to delete this announcement?')) {
                let savedAnnouncements = JSON.parse(localStorage.getItem('pragatiAnnouncements') || '{}');
                
                if (savedAnnouncements[key]) {
                    delete savedAnnouncements[key];
                    localStorage.setItem('pragatiAnnouncements', JSON.stringify(savedAnnouncements));
                    updateSavedAnnouncementsList();
                    showToast('Announcement deleted successfully!');
                }
            }
        }
        
        function updateSavedAnnouncementsList() {
            const listElement = document.getElementById('savedAnnouncementsList');
            const savedAnnouncements = JSON.parse(localStorage.getItem('pragatiAnnouncements') || '{}');
            
            // Clear the list
            listElement.innerHTML = '';
            
            // Check if there are any saved announcements
            if (Object.keys(savedAnnouncements).length === 0) {
                listElement.innerHTML = `
                    <div class="saved-announcement-item" style="padding: 8px 12px; border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center;">
                        <span class="saved-announcement-title" style="font-weight: 500;">No saved announcements yet</span>
                    </div>
                `;
                return;
            }
            
            // Add each saved announcement to the list
            for (const [key, data] of Object.entries(savedAnnouncements)) {
                const date = new Date(data.savedAt || Date.now()).toLocaleDateString();
                const item = document.createElement('div');
                item.className = 'saved-announcement-item';
                item.style.padding = '8px 12px';
                item.style.borderBottom = '1px solid var(--border-color)';
                item.style.display = 'flex';
                item.style.justifyContent = 'space-between';
                item.style.alignItems = 'center';
                
                item.innerHTML = `
                    <span class="saved-announcement-title" style="font-weight: 500;">${data.title || key}</span>
                    <div class="saved-announcement-actions" style="display: flex; gap: 5px;">
                        <span class="saved-announcement-date" style="font-size: 12px; color: #666;">${date}</span>
                        <span class="load-action" style="cursor: pointer; padding: 3px 6px; border-radius: 3px; font-size: 12px; color: var(--primary-color);" data-key="${key}">Load</span>
                        <span class="delete-action" style="cursor: pointer; padding: 3px 6px; border-radius: 3px; font-size: 12px; color: #e74c3c;" data-key="${key}">Delete</span>
                    </div>
                `;
                listElement.appendChild(item);
            }
            
            // Add event listeners
            listElement.querySelectorAll('.load-action').forEach(btn => {
                btn.addEventListener('click', () => loadAnnouncement(btn.dataset.key));
            });
            
            listElement.querySelectorAll('.delete-action').forEach(btn => {
                btn.addEventListener('click', () => deleteAnnouncement(btn.dataset.key));
            });
        }

        // --- Event Listeners Setup --- 
        document.addEventListener('DOMContentLoaded', function() {
            updateAnnouncement();
            
            // Export PDF button
            document.getElementById('exportPdfButton').addEventListener('click', exportToPDF);
            
            // Export Image button
            document.getElementById('exportImageButton').addEventListener('click', exportToImage);
            
            // Generate/Update button
            document.getElementById('generateButton').addEventListener('click', updateAnnouncement);
            
            // Logo Upload event listener
            elements.logoUpload.addEventListener('change', handleLogoUpload);
            
            // Logo Text Input event listener for real-time updates
            elements.logoTextInput.addEventListener('input', updateAnnouncement);
            
            // Save/Load button
            const saveLoadButton = document.getElementById('saveLoadButton');
            const saveLoadPanel = document.getElementById('saveLoadPanel');
            saveLoadButton.addEventListener('click', function() {
                saveLoadPanel.style.display = saveLoadPanel.style.display === 'none' ? 'block' : 'none';
                
                // Update the list when opening
                if (saveLoadPanel.style.display === 'block') {
                    updateSavedAnnouncementsList();
                }
            });
            
            // Save button
            document.getElementById('saveButton').addEventListener('click', function() {
                const name = document.getElementById('saveNameInput').value.trim();
                const data = getCurrentAnnouncementData();
                saveAnnouncement(name, data);
                document.getElementById('saveNameInput').value = '';
            });
            
            // Toast close button
            const toastClose = document.querySelector('.toast-close');
            if (toastClose) {
                toastClose.addEventListener('click', function() {
                    const toast = document.getElementById('toastNotification');
                    toast.style.transform = 'translateY(100px)';
                    toast.style.opacity = '0';
                });
            }
            
            // Add event listeners to theme options
            elements.themeOptions.forEach(option => {
                option.addEventListener('click', function() {
                    // Remove selected class from all options
                    elements.themeOptions.forEach(opt => opt.classList.remove('selected'));
                    // Add selected class to clicked option
                    this.classList.add('selected');
                    
                    // Apply theme colors
                    const theme = this.dataset.theme;
                    applyTheme(theme);
                    updateAnnouncement();
                });
            });
        });
        
        // Show toast notification function
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toastNotification');
            const toastMessage = toast.querySelector('.toast-message');
            const toastIcon = toast.querySelector('.toast-icon');
            
            // Set message
            toastMessage.textContent = message;
            
            // Set icon based on type
            if (type === 'error') {
                toastIcon.textContent = '⚠️';
                toast.style.background = '#e74c3c';
            } else if (type === 'info') {
                toastIcon.textContent = 'ℹ️';
                toast.style.background = '#3498db';
            } else {
                toastIcon.textContent = '✓';
                toast.style.background = 'var(--primary-color)';
            }
            
            // Show toast
            toast.style.transform = 'translateY(0)';
            toast.style.opacity = '1';
            
            // Hide toast after 3 seconds
            setTimeout(function() {
                toast.style.transform = 'translateY(100px)';
                toast.style.opacity = '0';
            }, 3000);
        }
    </script>
</body>
</html> 